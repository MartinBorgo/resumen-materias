La **integración numérica** es una técnica utilizada para aproximar el valor de integrales definidas cuando la función no tiene una antiderivada explícita o cuando la evaluación de la integral exacta es compleja. Los métodos de cuadratura numérica se basan en sumar evaluaciones de la función en puntos específicos, utilizando polinomios interpolantes para aproximar el área bajo la curva. Dos métodos comunes son la ***regla del trapecio*** y la ***regla de Simpson***.

### Regla del Trapecio

Este método es una fórmula de cuadratura de Newton-Cotes que aproxima la integral de una función $f(x)$ en un intervalo $[a, b]$ utilizando una línea recta entre dos puntos. Se basa en el polinomio interpolante de primer grado.


$$\int_a^b f(x) dx \approx \frac{b - a}{2} \left[ f(a) + f(b) \right]$$

Este método considera el área bajo la curva como un trapecio, donde las bases son los valores de la función en los extremos del intervalo $a$ y $b$. Para mejorar la precisión, se puede dividir el intervalo $[a, b]$ en $n$ subintervalos de igual tamaño $h = \frac{b - a}{n}$. La fórmula generalizada es:

$$\int_a^b f(x) dx \approx \frac{h}{2} \left[ f(x_0) + 2 \sum_{i=1}^{n-1} f(x_i) + f(x_n) \right]$$

Donde $x_0$ es el extremo inferior $a$, $x_n$ es el extremo superior $b$ y los $x_i$ son los puntos intermedios. El error de aproximación para este método está dado por la fórmula:

$$E_T = -\frac{(b - a)^3}{12n^2} f''(\xi)$$

En donde $\xi \in [a, b]$.

### Regla de Simpson

La regla de Simpson se basa en el polinomio interpolante de segundo grado, lo que la hace más precisa que la regla del trapecio. Aproxima la integral de una función $f(x)$ en el intervalo $[a, b]$ usando parábolas entre tres puntos consecutivos. La fórmula es la siguiente


$$\int_a^b f(x) dx \approx \frac{h}{3} \left[ f(x_0) + 4 f(x_1) + f(x_2) \right]$$

Donde $h = \frac{b - a}{2}$, y $x_0 = a$, $x_1 = \frac{a + b}{2}$, $x_2 = b$. Si se divide el intervalo en $n$ subintervalos (donde $n$ es par), la fórmula generalizada es:

$$\int_a^b f(x) dx \approx \frac{h}{3} \left[ f(x_0) + 4 \sum_{i \text{ impares}} f(x_i) + 2 \sum_{i \text{ pares}} f(x_i) + f(x_n) \right]$$

Con $h = \frac{b - a}{n}$. El error de aproximación del método de Simpson está dado por:

$$E_S = -\frac{(b - a)^5}{180n^4} f^{(4)}(\xi)$$

En donde $\xi \in [a, b]$.

## Comparación de métodos

- **Regla del trapecio**: Aproxime la integral utilizando líneas rectas. Tiene un error de orden $O(h^2)$ y es fácil de implementar, pero no es muy precisa con pocos subintervalos.
- **Regla de Simpson**: Aproxime la integral utilizando parábolas. Tiene un error de orden $O(h^4)$, lo que la hace mucho más precisa que la regla del trapecio para el mismo número de subintervalos.

Ambos métodos son útiles para aproximar integrales cuando no se puede obtener una solución exacta analíticamente, y se pueden mejorar dividiendo el intervalo de integración en más subintervalos.

>[!tldr] Condiciones de Aplicación para Trapecio y Simpson
> Condiciones para aplicar la Regla del Trapecio:
> 1. **Suavidad de la función**: Se aplica mejor cuando la función $f(x)$ es continua y no tiene oscilaciones o cambios bruscos. Funciones con discontinuidades pueden generar errores significativos.
> 2. **Número de subintervalos**: Aumentar el número de subintervalos $n$ reduce el error. El método funciona bien cuando la función es aproximadamente lineal en pequeños intervalos.
> 3. **Exactitud**: Es exacta para polinomios de primer grado, pero para funciones más complejas se requieren más subintervalos para una aproximación precisa.
> 
> Condiciones para aplicar la Regla de Simpson:
> 1. **Número par de subintervalos**: Se requiere un número par de subintervalos $n$, ya que el método utiliza tres puntos en cada subintervalo.
> 2. **Continuidad y suavidad**: Funciona mejor cuando la función es suave y diferenciable varias veces. Para funciones con discontinuidades, puede ser necesario aumentar el número de subintervalos.
> 3. **Exactitud**: Es más precisa para polinomios de segundo y tercer grado, pero para funciones oscilantes se necesitarán más subintervalos.
>  
> Consideraciones Generales:
> - **Error acumulado**: En ambos métodos, el error disminuye al aumentar el número de subintervalos $n$, pero la regla de Simpson tiene un orden de convergencia mayor que la del trapecio.
> - **Regularidad en los puntos**: Se asume que los puntos están distribuidos de forma equidistante. Si no lo están, se deben usar variantes de estos métodos.
> - **Oscilaciones**: Para funciones con oscilaciones fuertes, ambos métodos pueden requerir una mayor cantidad de subintervalos o el uso de métodos adaptativos.