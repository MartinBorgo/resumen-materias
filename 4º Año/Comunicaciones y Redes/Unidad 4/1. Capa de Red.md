La función de la capa de red es simple, es la encartada de transporta paquetes desde un host emisor a un host receptor. En la realización de esta tarea podemos identificar dos importantes funciones de la capa de red:

1. **Reenvío (forwarding)**: Cuando un paquete llega al enlace de entrada de un router, éste tiene que pasar el paquete al enlace de salida apropiado. Por ejemplo, un paquete que llega procedente de $H_1$ al router $R_1$ debe ser reenviado al siguiente router de la ruta hacia $H_2$, es decir, hacia su destino.
2. **Enrutamiento (routing)**: La capa de red tiene que determinar la ruta o camino que deben seguir los distintos paquetes a medida que fluyen desde emisor al receptor. Los algoritmos que calculan estas rutas se conocen como ***algoritmos de enrutamiento***.

Todo router tiene una tabla de reenvío. Un router reenvía un paquete examinando el valor de un campo de la cabecera del paquete entrante y utilizando después ese valor para indexarlo dentro de la tabla de reenvío del router. El resultado de la tabla de reenvío indica a
cuál de las interfaces del enlace de salida del router será reenviado el paquete. En ocasiones se emplea el término de ***conmutador de paquetes*** para referirnos a un dispositivo de conmutación de paquetes general que transfiere un paquete desde la interfaz del enlace de entrada a la interfaz del enlace de salida, de acuerdo con el valor almacenado en un campo de la cabecera del paquete, aunque algunos conmutadores basan su decisión de acurdo al campo de la cabecera de la capa de enlace, mientras que otros lo basan en el campo de la cabecera de la capa de red.

>[!example] Conmutación de Paquetes y Conmutación de Circuitos
>Al momento de realizar el intercambio de paquetes entre dos equipos se pueden emplear dos métodos de comunicación diferentes:
>- **Comunicación de Circuitos**: Este método implica establecer un camino físico dedicado entre el origen y el destino antes de que la comunicación comience. La conmutación de circuitos garantiza una cantidad constante de ancho de banda y generalmente proporciona una baja variabilidad en el retardo de los paquetes, garantizando el orden en el que se envían los paquetes, lo que es ideal para servicios como llamadas de voz o transmisión de video.
>- **Comunicación de Paquetes**: En este método, los datos se dividen en paquetes pequeños, que se envían a través de la red de manera independiente. Cada paquete puede tomar rutas diferentes para llegar al destino, donde finalmente son reensamblados en el orden correcto, esto permite enviar paquetes de múltiples comunicaciones a través del mismos enlaces de red.

El **modelo de servicio de red** define las características del transporte punto a punto de los paquetes entre los sistemas terminales emisor y receptor. La capa de red de Internet proporciona un único servicio conocido como ***servicio de mejor esfuerzo*** en la cual la temporización relativa entre paquetes no está garantizada, tampoco está garantizado que los paquetes se reciban en el orden que fueron emitidos y tampoco garantiza la entrega de los paquetes al destino.
Al igual que la capa de transporte, la capa de red proporciona dos tipos de servicios de conexión, un servicio sin conexión y otro con conexión. Las redes de computadoras que sólo proporcionan un servicio de conexión en la capa de red se conocen como ***redes de circuitos virtuales***. Mientras que las redes que sólo proporcionan un servicio sin conexión en la capa de red se denominan ***redes de datagramas***.

## Redes de Circuitos Virtuales

Un circuito virtual esta compuesto por:

1. Una ruta entre los hosts de origen y de destino.
2. Una serie de números de circuito virtual, un número para cada enlace a lo largo de la ruta.
3. Una serie de entradas en la tabla de reenvío de cada router a lo largo de la ruta.

Un paquete que pertenece a un circuito virtual transportará un número de circuito virtual en su cabecera. Dado que un circuito virtual puede tener un número diferente en cada enlace, cada router interviniente tiene que sustituir el número de circuito virtual de cada paquete que lo atraviesa por un nuevo. Este nuevo número se obtiene de la tabla de reenvío.
En una red de circuitos virtuales, los routers de la red tienen que mantener información de estado de la conexión para las conexiones activas. Específicamente, cada vez que se establece una conexión nueva en un router, tiene que añadirse una nueva entrada de conexión a la tabla de reenvío del router; y cada vez que una conexión se libera, la entrada debe borrarse de la tabla.
Cuando se establece la conexión entre dos máquinas a través de un circuito virtual, la capa de red especifica la dirección de receptor, luego se configura el circuito virtual y se establece por que enlaces y routers pasará el mensaje, además puede que durante esta configuración la red reserve recursos a lo largo de toda la ruta, dado que todos los paquetes siguen el mismo camino dentro de la red, se garantiza que llegarán al destino en el mismo orden en que se enviaron, lo que es especialmente importante para aplicaciones sensibles al orden, como la transmisión de voz o video. Una vez se establece la configuración comienza el envío de paquetes.
Los mensajes que los sistemas terminales envían a la red para iniciar o terminar un circuito virtual y los mensajes pasados entre los routers para configurar este mismo se conocen como ***mensajes de señalización*** y los protocolos empleados para intercambiar estos mensajes a menudo se denominan ***protocolos de señalización***.

## Redes de Datagramas

En una red de datagramas, cada vez que un sistema terminal desea enviar un paquete marca el paquete con la dirección del sistema terminal de destino y luego introduce el paquete en la red. Cuando un paquete se transmite desde un origen a un destino pasa a través de una serie de routers. Cada uno de estos routers utiliza la dirección de destino del paquete para reenviar dicho paquete, cuando un paquete llega a un router, éste utiliza la dirección de destino del paquete para buscar la interfaz del enlace de salida apropiado en la
tabla de reenvío. Después, el router reenvía intencionadamente el paquete a esa interfaz del
enlace de salida.
En las red de datagramas las tablas de reenvío son modificadas por los algoritmos de enrutamiento, que normalmente actualizan una tabla de reenvío en intervalos aproximados de entre uno y cinco minutos, al contrario que en los circuitos virtuales donde las tablas se actualizaban cada vez que se configura una conexión a través de ese router.

### Funciones Principales en la Conmutación de Paquetes

En el ámbito de las redes de datos, el manejo eficiente del tráfico de información es crucial para el desempeño óptimo del sistema. Dos componentes fundamentales en esta gestión son las **estrategias de encaminamiento** y el **control de congestión**.

- **Estrategias de encaminamiento:** Ya sea un red datagrama o en las redes de circuito virtual, la selección del camino a seguir por un paquete a través de los nodos de la red hasta llegar a su destino es fundamental. A la hora de la selección de la ruta adecuada se emplean diversos mecanismos, tales como como:
    - **Estático:** Se establece un camino fijo entre cada par de nodos.
    - **Inundación:** Consiste en enviar el paquete hacia todos los nodos vecinos, de la tabla de reenvios del router.
    - **Aleatorio:** Se elige una salida al azar en cada nodo al que llega el paquete.
    - **Adaptable:** El encaminamiento se ajusta según las condiciones de la red, lo que puede incluir la congestión o la disponibilidad de rutas alternativas.

- **Control de Congestión**: Busca regular el flujo de datos para prevenir la saturación de la memoria de los distintos nodos de la red. Los mecanismos de control de congestión se basan generalmente en dos estrategias principales:
    - **Descarte del paquete de entrada:** Si los paquetes entran a una velocidad mayor que la que pueden ser procesados o enviados, se descartan los paquetes adicionales.
    - **Evitar que el paquete sea enviado por el nodo anterior:** Se puede notificar al nodo anterior para que reduzca la velocidad de envío de paquetes, ayudando así a regular el flujo de datos.

Estas funciones son esenciales para garantizar un enrutamiento eficiente de los paquetes y para mantener un control adecuado del tráfico en la red de conmutación de paquetes, asegurando así un funcionamiento óptimo y confiable del sistema de comunicaciones.
