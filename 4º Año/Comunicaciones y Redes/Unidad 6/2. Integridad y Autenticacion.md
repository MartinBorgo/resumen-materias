Al momento de enviar mensajes a través de la red uno de los factores más decisivos es asegurar la integridad de los mismos y la autenticidad del emisor que envío todos los mensajes. La integridad de los datos nos sirve para corroborar que el mensaje no haya sido alterado o corrompido ya sea por un atacante o por propiedades físicas de los medios de transmisión, como se vio en la unidad anterior. Por otro lado, la autenticidad se refiere a corroborar si el mensaje que recibió el receptor en realidad proviene de ese emisor o se trata de alguien más que trata de hacerse pasar por él.
Ambos factores, es decir, tanto la integridad como la autenticidad de los datos pueden resolverse utilizando ***funciones hash criptográficas*** que funcionan de manera similar a las sumas de comprobaciones vistas en las anteriores unidades, este tipo de funciones toman una entrada de longitud variable y produce como salida un valor de longitud fija.

>[!info] Propiedades Deseables de una Función Hash
>Debido a que las funciones hash retornan una cadena de longitud fija, es probable que dos mensajes diferentes posean el mismo hash. Una propiedad deseable de este tipo de funciones es que esta probabilidad se disminuya al mínimo, algoritmos como el MD5 y la familia de los algoritmos SHA cumplen con estas características.

Si bien las funciones hash permiten asegurar la integridad de los mensajes, este método por sí solo no permite asegurar la autenticidad del mismo. Para asegurar la autenticidad del mensaje tanto el emisor como el receptor deben compartir una ***clave de autenticación***, esta clave no es más que una cadena de bits que se concatena junto con el mensaje al momento de calcular el hash, este código recibe el nombre de ***código de autenticación de mensajes (MAC)***. De esta forma el receptor podrá verificar si el mensaje ha sido alterado, al mismo tiempo que autentica la procedencia del mismo, ya que solo el emisor y el receptor conocen la clave de autenticación.

![[autenticacion-funcionamiento.png]]

Una característica muy conveniente de los códigos de autenticación de mensajes es que no se necesita ningún algoritmo de cifrado, lo que ahorra a muchas aplicaciones el uso de complejos algoritmos de cifrado. Por ejemplo, el protocolo OSPF utiliza códigos MAC para verificar la autenticidad e integridad de los mensajes, esto resulta beneficioso en este tipo de sistemas donde la velocidad y el rendimiento es un factor crítico.

## Firmas Digitales

Una ***firma digital*** es una técnica criptográfica que permite identificar al propietario o creador a algún objeto en el mundo digital. Al igual que ocurre con las firmas manuscritas, las firmas digitales deben realizarse de forma que sean verificables y no falsificables. La forma más apropiada de implementar este tipo técnicas de identificación y verificación es utilizando esquemas de criptografía de clave pública.
La forma más sencilla de implementar una firma digital es encriptar el mensaje o documento utilizando la clave privada. Los receptores, gracias a las propiedades algebraicas del sistema de clave pública, pueden desencriptar dicho documento o mensaje utilizando la clave pública provista por el emisor. Cabe recalcar que no importa el mensaje o documento en sí mismo, sino el exponer que esta técnica puede utilizarse para verificar al propietario de algún objeto digital, aunque también puede utilizarse para verificar la integridad de los datos.
Uno de los problemas con la firma de datos mediante mecanismos de cifrado es que el cifrado y el descifrado son computacionalmente muy caros. Una técnica más eficiente consiste en introducir funciones hash en el mecanismo de firma digital, de este modo primero se calcula un hash sobre el mensaje y luego se encripta este hash con la clave privada, gracias a que el hash es generalmente mucho más corto que los mensajes, el poder de cómputo necesario para generar la firma digital se reduce significativamente. El emisor solo debería adjuntar el producto resultante de esta encriptación junto con el mensaje, de este modo el receptor podrá verificar la autenticidad del mensaje.

### Verificación de Clave Pública

Una importante aplicación de las firmas digitales es la certificación de clave pública, es decir, certificar que una clave pública pertenece a una entidad específica. Las técnicas de certificación de clave pública se utilizan en muchos protocolos populares de seguridad para las comunicaciones de red, incluyendo IPsec y SSL.
Para que la criptografía de clave pública resulte útil necesitamos poder verificar que disponemos de la verdadera clave pública de la entidad con la que queremos comunicarnos. La asociación entre una clave pública y una entidad concreta normalmente la realiza una ***autoridad de certificación (CA)***, cuyo trabajo consiste en validar las identidades y emitir los certificados. Una autoridad de certificación desempeña los siguientes papeles:

1. Verifica que una entidad es quien dice ser. No hay ningún procedimiento establecido para la forma en que una autoridad verificadora se lleva a cabo esa certificación. En pocas palabras uno debe depositar cierta confianza en ente tipo de entidades.
2. Una vez que la autoridad comprueba la identidad de la entidad, la autoridad certificadora genera un certificado que asocia con esa entidad su correspondiente clave pública. El certificado contiene la clave pública y la información de identificación globalmente distintiva acerca del propietario de la clave pública.

Tanto la Unión Internacional de Telecomunicaciones (ITU) como el IETF han desarrollado estándares para las autoridades de certificación. La ITU X.509 especifica un servicio de autenticación, así como una sintaxis específica para los certificados. Por otro lado, RFC 1422 describe un mecanismo de administración de claves basado en autoridades de certificación para su utilización con el correo electrónico seguro a través de Internet.

## Autenticación del Punto Terminal

La autenticación del punto terminal es el proceso de demostrar a alguien la propia identidad. Es decir, es el proceso de validar tu identidad a través de un terminal.
La autenticación puede realizarse mediante código de autenticación de mensajes, con la desventaja de que el receptor queda expuesto a ***ataques de reproducción***, esto se puede solucionar utilizando ***números distintivos***, que son números que se utilizaran una única vez durante la comunicación. Al momento de intercambiar datos el receptor selecciona un número distintivo $R$ y se lo envía al emisor, el emisor calcula su código MAC utilizando la clave de autenticación y el número distintivo enviado por el receptor. Al recibir el mensaje y calcula de nuevo el código MAC utilizando clave de autenticación y el número distintivo, si el código coincide entonces el mensaje proviene efectivamente del emisor y no de un atacante.

